<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Study: Orbital Velocties · EphemerisSources.jl</title><meta name="title" content="Study: Orbital Velocties · EphemerisSources.jl"/><meta property="og:title" content="Study: Orbital Velocties · EphemerisSources.jl"/><meta property="twitter:title" content="Study: Orbital Velocties · EphemerisSources.jl"/><meta name="description" content="Documentation for EphemerisSources.jl."/><meta property="og:description" content="Documentation for EphemerisSources.jl."/><meta property="twitter:description" content="Documentation for EphemerisSources.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">EphemerisSources.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Overview</span><ul><li><a class="tocitem" href="../../">About Ephemeris</a></li><li><input class="collapse-toggle" id="menuitem-1-2" type="checkbox" checked/><label class="tocitem" for="menuitem-1-2"><span class="docs-label">Quick Start</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/">EphemerisSources.jl</a></li><li><a class="tocitem" href="../spice/">SPICE</a></li><li><a class="tocitem" href="../horizons/">Horizons</a></li><li><a class="tocitem" href="../telescope-study/">Study: JWST and Gaia</a></li><li class="is-active"><a class="tocitem" href>Study: Orbital Velocties</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Overview</a></li><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href>Study: Orbital Velocties</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Study: Orbital Velocties</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAstro/EphemerisSources.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAstro/EphemerisSources.jl/blob/main/docs/src/examples/velocity-study/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Case-Study:-Orbital-Velocities"><a class="docs-heading-anchor" href="#Case-Study:-Orbital-Velocities">Case Study: Orbital Velocities</a><a id="Case-Study:-Orbital-Velocities-1"></a><a class="docs-heading-anchor-permalink" href="#Case-Study:-Orbital-Velocities" title="Permalink"></a></h1><p>You may have learned that the velocity of an idealized circular orbit –- a  massless particle moving in the Newtonian gravitational field of a single  point-mass –- is related to the radius of the orbit: to increase your orbital  radius, increase your speed. More formally, the speed of an massless particle in  this same idealized circular orbit can be found by taking the square root of  the mass parameter divided by orbital radius. The planets in our solar system  have near-circular orbits. We can compare their speeds, and recover the  relationship that orbital speed has with orbital radius. </p><p class="math-container">\[V = \sqrt{\frac{\mu}{r}}\]</p><p>First, let&#39;s load the proper ephemeris data using <code>SPICEKernels</code>, <code>SPICEBodies</code>, and <code>SPICE</code>. We will load the planet&#39;s <em>barycenters</em> here: the center of mass of their orbital system (the planet, and its moons). Just for fun, let&#39;s include Pluto and see what happens!</p><pre><code class="language-julia hljs">using SPICE, SPICEKernels, SPICEBodies

furnsh(
    de440s(),                   # position and velocity data for inner planet
    latest_leapseconds_lsk(),   # timekeeping, parsing epochs
    gm_de440(),                 # mass parameters for major solar system bodies
    pck00011(),                 # physical properties of major solar system bodies
)

mercury = KernelBody(&quot;mercury barycenter&quot;)
venus = KernelBody(&quot;venus barycenter&quot;)
earth = KernelBody(&quot;earth barycenter&quot;)
mars = KernelBody(&quot;mars barycenter&quot;)
jupiter = KernelBody(&quot;jupiter barycenter&quot;)
saturn = KernelBody(&quot;saturn barycenter&quot;)
uranus = KernelBody(&quot;uranus barycenter&quot;)
neptune = KernelBody(&quot;neptune barycenter&quot;)
pluto = KernelBody(&quot;pluto barycenter&quot;)

planets = (mercury, venus, earth, mars, jupiter, saturn, uranus, neptune, pluto)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(KernelBody(1), KernelBody(2), KernelBody(3), KernelBody(4), KernelBody(5), KernelBody(6), KernelBody(7), KernelBody(8), KernelBody(9))</code></pre><p>All of these orbits are near circular, with the exception of Mercury, and one  pesky ex-planet. A perfectly circular orbit will have an eccentricity of zero. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Mercury&#39;s orbit is non-circular due to general relativity!</p></div></div><pre><code class="language-julia hljs">using Dates
using DataFrames
using AstrodynamicalCalculations

average_eccentricity(planet) = let epoch = now()
    times = epoch - Year(15) : Day(1) : epoch + Year(15)
    ecc(state) = AstrodynamicalCalculations.eccentricity(
        state.x, state.y, state.z, state.ẋ, state.ẏ, state.ż, gm(:sun)
    )

    return sum(time -&gt; ecc(planet(time; wrt=:sun)), times) / length(times)
end

name(planet) = bodc2n(SPICEBodies.naifcode(planet))

eccentricities = Dict(
    name(planet) =&gt; average_eccentricity(planet)
    for planet in planets
)

DataFrame(
    Name = [pair.first for pair in eccentricities],
    Eccentricity = [pair.second for pair in eccentricities]
)</code></pre><div><div style = "float: left;"><span>9×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Eccentricity</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">MERCURY BARYCENTER</td><td style = "text-align: right;">0.205636</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">EARTH BARYCENTER</td><td style = "text-align: right;">0.0166963</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">JUPITER BARYCENTER</td><td style = "text-align: right;">0.0484954</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">SATURN BARYCENTER</td><td style = "text-align: right;">0.0541185</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">NEPTUNE BARYCENTER</td><td style = "text-align: right;">0.0105404</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">MARS BARYCENTER</td><td style = "text-align: right;">0.093425</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">VENUS BARYCENTER</td><td style = "text-align: right;">0.00675963</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">URANUS BARYCENTER</td><td style = "text-align: right;">0.0471437</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">PLUTO BARYCENTER</td><td style = "text-align: right;">0.249386</td></tr></tbody></table></div><p>With their (mostly) near-circular orbits established, let&#39;s choose an epoch at  random and plot their orbital speed, and their <em>expected</em> orbital speed due to  the idealized calculation. </p><pre><code class="language-julia hljs">using Plots
using LinearAlgebra

epoch = now()

radius(planet) = let state = planet(epoch)
    return sqrt(state.x^2 + state.y^2 + state.z^2)
end

actual_speed(planet) = let state = planet(epoch)
    return sqrt(state.ẋ^2 + state.ẏ^2 + state.ż^2)
end

ideal_speed(planet) = let state = planet(epoch)
    return AstrodynamicalCalculations.orbital_speed(
        state.x, state.y, state.z, state.ẋ, state.ẏ, state.ż, gm(:sun)
    )
end

artsy = (;
    background=:transparent,
    grid=false,
    markersize=8,
    dpi=200,
    xlabel = &quot;Radius (KM)&quot;,
    ylabel = &quot;Speed (KM/S)&quot;,
    xaxis=:log
)

fig = plot(; title = &quot;Measured Orbital Speed&quot;, artsy...)

for planet in planets
    scatter!(fig, [radius(planet)], [actual_speed(planet)]; label = name(planet))
end

plot!(r -&gt; sqrt(gm(:sun)/r); label = &quot;Theoretical Speed&quot;)</code></pre><img src="index-578fed1e.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../telescope-study/">« Study: JWST and Gaia</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 10 October 2024 13:12">Thursday 10 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
